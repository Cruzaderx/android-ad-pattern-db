{
    "metadata": {
        "category": "UI Attack Vectors",
        "version": "1.0.0",
        "last_updated": "2025-02-22T06:57:00Z",
        "description": "UI-based security vulnerabilities in Android applications including clickjacking, tapjacking, and overlay attacks"
    },
    "vulnerabilities": [
        {
            "id": "UI-001",
            "name": "Tapjacking via Overlay",
            "description": "Application is vulnerable to tapjacking attacks through malicious overlays due to insufficient touch event filtering.",
            "severity": {
                "level": "High",
                "impact": "UI manipulation, unauthorized actions, and user deception",
                "exploitability": "Medium"
            },
            "detection": {
                "pattern": [
                    "(?<!setFilterTouchesWhenObscured\\(true\\))[^;]*extends\\s+(Button|EditText|View)",
                    "FLAG_WINDOW_IS_OBSCURED",
                    "onFilterTouchEventForSecurity",
                    "android:filterTouchesWhenObscured=\"false\""
                ],
                "method": "static",
                "indicators": [
                    "Touch event handling",
                    "View configuration",
                    "Security filtering",
                    "Overlay detection"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Custom view usage",
                        "Touch event handling",
                        "Security flags"
                    ],
                    "exclusion_patterns": [
                        "setFilterTouchesWhenObscured\\(true\\)",
                        "filterTouchesWhenObscured=\"true\"",
                        "checkTouchSecurity"
                    ],
                    "validation_steps": [
                        "Check touch filtering",
                        "Analyze view flags",
                        "Review event handling",
                        "Verify security measures"
                    ],
                    "context_requirements": [
                        "UI interaction",
                        "Touch event processing"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 95,
                    "manual_review": 85
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Create transparent overlay",
                    "Position over target view",
                    "Intercept touch events",
                    "Forward malicious actions",
                    "Hide overlay presence"
                ],
                "requirements": [
                    "SYSTEM_ALERT_WINDOW permission",
                    "Overlay creation capability",
                    "Touch event manipulation"
                ],
                "verification": {
                    "test_cases": [
                        "Create overlay window",
                        "Capture touch events",
                        "Execute hidden actions"
                    ],
                    "expected_results": [
                        "Overlay accepted",
                        "Events intercepted",
                        "Actions triggered"
                    ]
                }
            },
            "affected_components": [
                "UI components",
                "Touch handling",
                "View hierarchy"
            ],
            "tags": [
                "tapjacking",
                "overlay",
                "touch-events",
                "ui-security"
            ]
        },
        {
            "id": "UI-002",
            "name": "Task Hijacking via Overlay",
            "description": "Application is vulnerable to task hijacking through malicious overlays that can intercept and manipulate user interactions with the task stack.",
            "severity": {
                "level": "High",
                "impact": "Task manipulation, credential theft, and session hijacking",
                "exploitability": "Medium"
            },
            "detection": {
                "pattern": [
                    "FLAG_ACTIVITY_NEW_TASK",
                    "FLAG_ACTIVITY_MULTIPLE_TASK",
                    "android:taskAffinity=",
                    "android:excludeFromRecents=\"false\""
                ],
                "method": "static",
                "indicators": [
                    "Task configuration",
                    "Activity flags",
                    "Task affinity",
                    "Recent tasks"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Task affinity defined",
                        "Activity launching",
                        "Task management"
                    ],
                    "exclusion_patterns": [
                        "android:taskAffinity=\"\"",
                        "excludeFromRecents=\"true\"",
                        "validateTaskStack"
                    ],
                    "validation_steps": [
                        "Check task affinity",
                        "Analyze launch modes",
                        "Review task flags",
                        "Verify stack security"
                    ],
                    "context_requirements": [
                        "Activity stack usage",
                        "Task management"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 85,
                    "dynamic_analysis": 90,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Create malicious activity",
                    "Set matching task affinity",
                    "Launch in target task",
                    "Overlay legitimate UI",
                    "Capture user input"
                ],
                "requirements": [
                    "Task affinity knowledge",
                    "Activity creation",
                    "UI mimicking capability"
                ],
                "verification": {
                    "test_cases": [
                        "Launch malicious task",
                        "Check task stack",
                        "Verify overlay"
                    ],
                    "expected_results": [
                        "Task hijacked",
                        "UI overlaid",
                        "Input captured"
                    ]
                }
            },
            "affected_components": [
                "Activity stack",
                "Task management",
                "UI components"
            ],
            "tags": [
                "task-hijacking",
                "overlay",
                "activity",
                "ui-security"
            ]
        },
        {
            "id": "UI-003",
            "name": "Toast Overlay Attack",
            "description": "Application is vulnerable to UI redressing through malicious toast messages that can overlay and manipulate legitimate UI elements.",
            "severity": {
                "level": "High",
                "impact": "UI manipulation, user deception, and unauthorized actions",
                "exploitability": "Medium"
            },
            "detection": {
                "pattern": [
                    "Toast\\.makeText\\([^,]+,\\s*[^,]+,\\s*Toast\\.LENGTH_LONG\\)",
                    "toast\\.setGravity\\([^)]+\\)",
                    "toast\\.setView\\([^)]+\\)",
                    "new Toast\\([^)]+\\)\\.show\\(\\)"
                ],
                "method": "static",
                "indicators": [
                    "Toast creation",
                    "Custom toast view",
                    "Toast positioning",
                    "Display duration"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Toast usage",
                        "Custom view setting",
                        "Position control"
                    ],
                    "exclusion_patterns": [
                        "validateToastContent",
                        "secureToastDisplay",
                        "checkOverlayPermission"
                    ],
                    "validation_steps": [
                        "Check toast content",
                        "Analyze positioning",
                        "Review custom views",
                        "Verify display time"
                    ],
                    "context_requirements": [
                        "Toast notification usage",
                        "UI interaction"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 85,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Create custom toast view",
                    "Position over target UI",
                    "Set extended duration",
                    "Chain toast displays",
                    "Capture interactions"
                ],
                "requirements": [
                    "Toast creation ability",
                    "Custom view design",
                    "Position calculation"
                ],
                "verification": {
                    "test_cases": [
                        "Display custom toast",
                        "Check positioning",
                        "Test interaction"
                    ],
                    "expected_results": [
                        "Toast overlaid",
                        "UI obscured",
                        "Input intercepted"
                    ]
                }
            },
            "affected_components": [
                "Toast notifications",
                "UI layout",
                "Touch handling"
            ],
            "tags": [
                "toast",
                "overlay",
                "ui-redressing",
                "user-interaction"
            ]
        }
    ]
}