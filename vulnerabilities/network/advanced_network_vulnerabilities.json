{
    "metadata": {
        "category": "Network Security",
        "version": "1.0.0",
        "last_updated": "2025-02-22T08:27:00Z",
        "description": "Advanced network security vulnerabilities in Android applications including protocol attacks, traffic manipulation, and API security issues"
    },
    "vulnerabilities": [
        {
            "id": "NET-004",
            "name": "Protocol Downgrade Attack",
            "description": "Application allows protocol version downgrade attacks, enabling the use of weaker security protocols and cryptographic algorithms.",
            "severity": {
                "level": "Critical",
                "impact": "Protocol weakening, security bypass, and data interception",
                "exploitability": "Medium"
            },
            "detection": {
                "pattern": [
                    "SSLContext\\.getInstance\\([^)]*\\)",
                    "TLS\\.setEnabledProtocols\\([^)]*\\)",
                    "(?<!validate)Protocol[A-Z][a-zA-Z]*\\.[^;]+",
                    "setSSLSocketFactory\\([^)]*\\)"
                ],
                "method": "static",
                "indicators": [
                    "Protocol selection",
                    "SSL/TLS config",
                    "Version handling",
                    "Socket factory"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Protocol config",
                        "Version control",
                        "Security settings"
                    ],
                    "exclusion_patterns": [
                        "enforceProtocol",
                        "checkVersion",
                        "validateTLS"
                    ],
                    "validation_steps": [
                        "Check protocols",
                        "Analyze versions",
                        "Review config",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "Network implementation",
                        "Protocol handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 85,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Intercept traffic",
                    "Force downgrade",
                    "Exploit weakness",
                    "Capture data",
                    "Bypass security"
                ],
                "requirements": [
                    "MITM capability",
                    "Protocol knowledge",
                    "Network control"
                ],
                "verification": {
                    "test_cases": [
                        "Force downgrade",
                        "Check protocol",
                        "Verify weakness"
                    ],
                    "expected_results": [
                        "Protocol downgraded",
                        "Security weakened",
                        "Data intercepted"
                    ]
                }
            },
            "affected_components": [
                "Network stack",
                "Protocol handler",
                "Security layer"
            ],
            "tags": [
                "network",
                "protocol",
                "downgrade",
                "tls"
            ]
        },
        {
            "id": "NET-005",
            "name": "WebSocket Hijacking",
            "description": "Application implements WebSocket connections without proper security controls, enabling connection hijacking and data manipulation.",
            "severity": {
                "level": "High",
                "impact": "Connection hijacking, data manipulation, and session compromise",
                "exploitability": "Medium"
            },
            "detection": {
                "pattern": [
                    "WebSocket\\([^)]*\\)",
                    "ws://[^\"']+",
                    "(?<!secure)WebSocketClient\\.[^;]+",
                    "onWebSocketMessage\\([^)]*\\)"
                ],
                "method": "static",
                "indicators": [
                    "WebSocket usage",
                    "Connection handling",
                    "Message processing",
                    "Socket management"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "WebSocket usage",
                        "Connection security",
                        "Message handling"
                    ],
                    "exclusion_patterns": [
                        "validateSocket",
                        "secureConnection",
                        "checkOrigin"
                    ],
                    "validation_steps": [
                        "Check connection",
                        "Analyze security",
                        "Review handling",
                        "Verify protection"
                    ],
                    "context_requirements": [
                        "WebSocket implementation",
                        "Connection security"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 85,
                    "dynamic_analysis": 90,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Identify socket",
                    "Analyze security",
                    "Hijack connection",
                    "Inject messages",
                    "Manipulate data"
                ],
                "requirements": [
                    "WebSocket knowledge",
                    "Network control",
                    "Message crafting"
                ],
                "verification": {
                    "test_cases": [
                        "Connect socket",
                        "Hijack session",
                        "Send messages"
                    ],
                    "expected_results": [
                        "Connection hijacked",
                        "Messages injected",
                        "Data manipulated"
                    ]
                }
            },
            "affected_components": [
                "WebSocket handler",
                "Connection manager",
                "Message processor"
            ],
            "tags": [
                "websocket",
                "hijacking",
                "connection",
                "messaging"
            ]
        },
        {
            "id": "NET-006",
            "name": "OAuth Token Theft",
            "description": "Application implements OAuth authentication without proper token protection, enabling token theft and account compromise.",
            "severity": {
                "level": "Critical",
                "impact": "Account compromise, unauthorized access, and identity theft",
                "exploitability": "Medium"
            },
            "detection": {
                "pattern": [
                    "access_token=[^&]+",
                    "Bearer\\s+[^\"'\\s]+",
                    "(?<!secure)OAuthToken\\.[^;]+",
                    "SharedPreferences\\.putString\\([^,]*token[^)]*\\)"
                ],
                "method": "static",
                "indicators": [
                    "Token handling",
                    "OAuth usage",
                    "Authentication",
                    "Token storage"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "OAuth implementation",
                        "Token handling",
                        "Storage security"
                    ],
                    "exclusion_patterns": [
                        "encryptToken",
                        "secureStorage",
                        "validateToken"
                    ],
                    "validation_steps": [
                        "Check storage",
                        "Analyze handling",
                        "Review security",
                        "Verify protection"
                    ],
                    "context_requirements": [
                        "OAuth implementation",
                        "Token management"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 85,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Locate token",
                    "Extract token",
                    "Bypass protection",
                    "Use token",
                    "Access account"
                ],
                "requirements": [
                    "OAuth knowledge",
                    "Token extraction",
                    "Authentication bypass"
                ],
                "verification": {
                    "test_cases": [
                        "Find token",
                        "Extract data",
                        "Use token"
                    ],
                    "expected_results": [
                        "Token stolen",
                        "Access gained",
                        "Account compromised"
                    ]
                }
            },
            "affected_components": [
                "OAuth system",
                "Token manager",
                "Authentication"
            ],
            "tags": [
                "oauth",
                "token",
                "authentication",
                "security"
            ]
        }
    ]
}