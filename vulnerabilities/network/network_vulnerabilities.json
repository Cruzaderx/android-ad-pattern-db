{
    "metadata": {
        "category": "Network Security",
        "version": "1.0.0",
        "last_updated": "2025-02-22T07:09:00Z",
        "description": "Network-related security vulnerabilities in Android applications including protocol weaknesses, API security issues, and traffic manipulation"
    },
    "vulnerabilities": [
        {
            "id": "NET-001",
            "name": "Cleartext Network Traffic",
            "description": "Application transmits sensitive data over unencrypted network connections, allowing traffic interception and data exposure.",
            "severity": {
                "level": "Critical",
                "impact": "Data exposure, credential theft, and privacy breach",
                "exploitability": "Easy"
            },
            "detection": {
                "pattern": [
                    "android:usesCleartextTraffic=\"true\"",
                    "http://[^s]",
                    "URL\\([\"']http://",
                    "HttpURLConnection(?!.*https)"
                ],
                "method": "static",
                "indicators": [
                    "HTTP usage",
                    "Cleartext traffic",
                    "Network config",
                    "Connection setup"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Network usage",
                        "HTTP protocol",
                        "Data transmission"
                    ],
                    "exclusion_patterns": [
                        "https://",
                        "HttpsURLConnection",
                        "enforceHttps"
                    ],
                    "validation_steps": [
                        "Check protocol",
                        "Analyze traffic",
                        "Review config",
                        "Verify encryption"
                    ],
                    "context_requirements": [
                        "Network communication",
                        "Data transmission"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 95,
                    "dynamic_analysis": 90,
                    "manual_review": 85
                }
            },
            "exploit": {
                "difficulty": "Easy",
                "steps": [
                    "Setup MITM proxy",
                    "Intercept traffic",
                    "Monitor data",
                    "Extract information",
                    "Modify requests"
                ],
                "requirements": [
                    "Network access",
                    "Proxy tools",
                    "Traffic analysis"
                ],
                "verification": {
                    "test_cases": [
                        "Monitor traffic",
                        "Capture data",
                        "Read content"
                    ],
                    "expected_results": [
                        "Traffic visible",
                        "Data readable",
                        "Content exposed"
                    ]
                }
            },
            "affected_components": [
                "Network layer",
                "Data transmission",
                "Protocol security"
            ],
            "tags": [
                "network",
                "cleartext",
                "mitm",
                "traffic"
            ]
        },
        {
            "id": "NET-002",
            "name": "Insecure Certificate Validation",
            "description": "Application accepts invalid or self-signed SSL certificates, enabling man-in-the-middle attacks and traffic interception.",
            "severity": {
                "level": "Critical",
                "impact": "Traffic interception, data theft, and connection hijacking",
                "exploitability": "Medium"
            },
            "detection": {
                "pattern": [
                    "X509TrustManager\\{[^}]*return\\s+true",
                    "HostnameVerifier\\{[^}]*return\\s+true",
                    "setHostnameVerifier\\(.*ALLOW_ALL",
                    "TrustAllCerts"
                ],
                "method": "static",
                "indicators": [
                    "Certificate validation",
                    "Trust manager",
                    "Hostname verification",
                    "SSL handling"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "SSL implementation",
                        "Certificate handling",
                        "Trust management"
                    ],
                    "exclusion_patterns": [
                        "validateCertificate",
                        "strictHostnameVerifier",
                        "pinCertificate"
                    ],
                    "validation_steps": [
                        "Check validation",
                        "Analyze trust",
                        "Review verification",
                        "Verify pinning"
                    ],
                    "context_requirements": [
                        "SSL usage",
                        "Certificate handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 95,
                    "manual_review": 85
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Generate fake cert",
                    "Setup MITM proxy",
                    "Present invalid cert",
                    "Intercept traffic",
                    "Decrypt communication"
                ],
                "requirements": [
                    "Certificate generation",
                    "MITM proxy",
                    "Network access"
                ],
                "verification": {
                    "test_cases": [
                        "Present fake cert",
                        "Monitor acceptance",
                        "Capture traffic"
                    ],
                    "expected_results": [
                        "Certificate accepted",
                        "Connection established",
                        "Traffic intercepted"
                    ]
                }
            },
            "affected_components": [
                "SSL implementation",
                "Certificate handling",
                "Trust management"
            ],
            "tags": [
                "ssl",
                "certificate",
                "mitm",
                "validation"
            ]
        },
        {
            "id": "NET-003",
            "name": "API Key Exposure",
            "description": "Application exposes sensitive API keys in network requests or application code, allowing unauthorized API access and quota theft.",
            "severity": {
                "level": "High",
                "impact": "API abuse, unauthorized access, and service theft",
                "exploitability": "Easy"
            },
            "detection": {
                "pattern": [
                    "api[_-]?key[\"']?\\s*[:=]\\s*[\"'][^\"\\']+[\"']",
                    "Authorization:\\s*Bearer\\s+[a-zA-Z0-9-_]+",
                    "access[_-]?token[\"']?\\s*[:=]\\s*[\"'][^\"\\']+[\"']",
                    "secret[_-]?key[\"']?\\s*[:=]\\s*[\"'][^\"\\']+[\"']"
                ],
                "method": "static",
                "indicators": [
                    "API key usage",
                    "Authorization header",
                    "Token storage",
                    "Secret handling"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "API communication",
                        "Key usage",
                        "Authentication"
                    ],
                    "exclusion_patterns": [
                        "getApiKey",
                        "loadCredentials",
                        "fetchToken"
                    ],
                    "validation_steps": [
                        "Check key storage",
                        "Analyze usage",
                        "Review exposure",
                        "Verify protection"
                    ],
                    "context_requirements": [
                        "API usage",
                        "Authentication"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 95,
                    "dynamic_analysis": 85,
                    "manual_review": 90
                }
            },
            "exploit": {
                "difficulty": "Easy",
                "steps": [
                    "Extract API key",
                    "Analyze API usage",
                    "Test key validity",
                    "Access API",
                    "Abuse services"
                ],
                "requirements": [
                    "API documentation",
                    "Key extraction",
                    "API testing tools"
                ],
                "verification": {
                    "test_cases": [
                        "Extract key",
                        "Test API access",
                        "Verify validity"
                    ],
                    "expected_results": [
                        "Key extracted",
                        "API accessible",
                        "Services usable"
                    ]
                }
            },
            "affected_components": [
                "API authentication",
                "Key management",
                "Service access"
            ],
            "tags": [
                "api",
                "keys",
                "exposure",
                "authentication"
            ]
        }
    ]
}