{
    "metadata": {
        "category": "Deeplink/URL Scheme Security",
        "version": "1.0.0",
        "last_updated": "2025-02-22T10:50:00Z",
        "description": "Deeplink and URL scheme vulnerabilities including scheme hijacking, parameter injection, and validation bypass"
    },
    "vulnerabilities": [
        {
            "id": "LINK-001",
            "name": "Deep Link Parameter Injection",
            "description": "Application fails to properly validate deep link parameters, enabling injection of malicious data.",
            "severity": {
                "level": "High",
                "impact": "Data injection and unauthorized access",
                "exploitability": "Medium"
            },
            "affects": {
                "component": "android.content.Intent",
                "filters": [
                    "android.intent.action.VIEW"
                ],
                "schemes": [
                    "http",
                    "https",
                    "custom-scheme"
                ],
                "data": "intent-filter/data"
            },
            "detection": {
                "pattern": [
                    "getIntent\\(\\)",
                    "getData\\(\\)",
                    "parseUri\\([^)]+\\)",
                    "<data android:scheme="
                ],
                "method": "static",
                "indicators": [
                    "Deep link handling",
                    "Parameter parsing",
                    "Data validation"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Deep link implementation",
                        "Parameter handling",
                        "Input validation"
                    ],
                    "exclusion_patterns": [
                        "validateParams",
                        "sanitizeInput",
                        "checkDeepLink"
                    ],
                    "validation_steps": [
                        "Check implementation",
                        "Analyze parsing",
                        "Review validation",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "Deep link implementation",
                        "Parameter handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 85,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Craft deep link",
                    "Inject parameters",
                    "Bypass validation",
                    "Execute payload",
                    "Access data"
                ],
                "requirements": [
                    "Deep link access",
                    "Parameter knowledge",
                    "Validation patterns"
                ],
                "verification": {
                    "test_cases": [
                        "Test injection",
                        "Check validation",
                        "Verify access"
                    ],
                    "expected_results": [
                        "Parameters injected",
                        "Validation bypassed",
                        "Data accessed"
                    ]
                }
            },
            "affected_components": [
                "Intent handler",
                "Parameter parser",
                "Data validator"
            ],
            "tags": [
                "deeplink",
                "injection",
                "validation",
                "parameters"
            ]
        },
        {
            "id": "LINK-002",
            "name": "URL Scheme Hijacking",
            "description": "Application's custom URL scheme can be hijacked by malicious apps to intercept and manipulate deep links.",
            "severity": {
                "level": "High",
                "impact": "Deep link interception and data theft",
                "exploitability": "Medium"
            },
            "affects": {
                "component": "android.content.IntentFilter",
                "manifest": "AndroidManifest.xml",
                "elements": [
                    "intent-filter",
                    "data"
                ],
                "schemes": [
                    "custom-scheme"
                ]
            },
            "detection": {
                "pattern": [
                    "<intent-filter>[^<]+<data",
                    "android:scheme=\"[^\"]+\"",
                    "android:host=\"[^\"]+\"",
                    "android:pathPattern="
                ],
                "method": "static",
                "indicators": [
                    "Scheme declaration",
                    "Intent filter",
                    "Deep link routing"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Scheme implementation",
                        "Filter declaration",
                        "Route handling"
                    ],
                    "exclusion_patterns": [
                        "validateScheme",
                        "checkRoute",
                        "verifyIntent"
                    ],
                    "validation_steps": [
                        "Check scheme",
                        "Analyze filters",
                        "Review routing",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "Scheme implementation",
                        "Route handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 85,
                    "dynamic_analysis": 90,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Register scheme",
                    "Intercept links",
                    "Manipulate data",
                    "Hijack flow",
                    "Extract information"
                ],
                "requirements": [
                    "Scheme knowledge",
                    "Intent filters",
                    "Routing patterns"
                ],
                "verification": {
                    "test_cases": [
                        "Register scheme",
                        "Test interception",
                        "Verify hijack"
                    ],
                    "expected_results": [
                        "Scheme registered",
                        "Links intercepted",
                        "Flow hijacked"
                    ]
                }
            },
            "affected_components": [
                "Intent filter",
                "Scheme handler",
                "Route manager"
            ],
            "tags": [
                "url-scheme",
                "hijacking",
                "routing",
                "interception"
            ]
        },
        {
            "id": "LINK-003",
            "name": "App Links Validation Bypass",
            "description": "Application's app links (universal links) implementation can be bypassed to enable unauthorized deep link handling.",
            "severity": {
                "level": "High",
                "impact": "Unauthorized deep link handling and data access",
                "exploitability": "Hard"
            },
            "affects": {
                "component": "android.content.Intent",
                "manifest": "AndroidManifest.xml",
                "elements": [
                    "intent-filter",
                    "data"
                ],
                "verification": "assetlinks.json"
            },
            "detection": {
                "pattern": [
                    "android:autoVerify=\"true\"",
                    "<data android:host=",
                    "/.well-known/assetlinks.json",
                    "getIntentVerifier"
                ],
                "method": "static",
                "indicators": [
                    "App links verification",
                    "Domain validation",
                    "Link handling"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "App links implementation",
                        "Verification process",
                        "Domain handling"
                    ],
                    "exclusion_patterns": [
                        "validateDomain",
                        "checkVerification",
                        "verifyAppLinks"
                    ],
                    "validation_steps": [
                        "Check verification",
                        "Analyze domains",
                        "Review handling",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "App links implementation",
                        "Domain handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 85,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Hard",
                "steps": [
                    "Bypass verification",
                    "Spoof domain",
                    "Handle links",
                    "Access data",
                    "Maintain access"
                ],
                "requirements": [
                    "Domain control",
                    "Verification knowledge",
                    "Link patterns"
                ],
                "verification": {
                    "test_cases": [
                        "Test verification",
                        "Check handling",
                        "Verify bypass"
                    ],
                    "expected_results": [
                        "Verification bypassed",
                        "Links handled",
                        "Access gained"
                    ]
                }
            },
            "affected_components": [
                "App links verifier",
                "Domain validator",
                "Link handler"
            ],
            "tags": [
                "app-links",
                "verification",
                "domain",
                "bypass"
            ]
        }
    ]
}