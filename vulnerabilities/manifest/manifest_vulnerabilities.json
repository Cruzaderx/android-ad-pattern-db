{
    "metadata": {
        "category": "Manifest Security",
        "version": "1.0.0",
        "last_updated": "2025-02-22T12:15:00Z",
        "description": "AndroidManifest.xml security vulnerabilities including component exposure, permission issues, and configuration weaknesses"
    },
    "vulnerabilities": [
        {
            "id": "MAN-001",
            "name": "Component Export Misconfiguration",
            "description": "Application's manifest exposes components without proper protection, allowing unauthorized access.",
            "severity": {
                "level": "Critical",
                "impact": "Component exposure and unauthorized access",
                "exploitability": "Easy"
            },
            "affects": {
                "component": "AndroidManifest.xml",
                "attributes": [
                    "android:exported",
                    "android:permission",
                    "android:protectionLevel"
                ],
                "elements": [
                    "activity",
                    "service",
                    "receiver",
                    "provider"
                ]
            },
            "detection": {
                "pattern": [
                    "<(activity|service|receiver|provider)[^>]+android:exported=\"true\"[^>]*>",
                    "<(activity|service|receiver|provider)[^>]+(?!android:permission)",
                    "intent-filter"
                ],
                "method": "static",
                "indicators": [
                    "Component export",
                    "Permission declaration",
                    "Intent filter"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Component declaration",
                        "Export handling",
                        "Permission validation"
                    ],
                    "exclusion_patterns": [
                        "android:permission=",
                        "android:protectionLevel=",
                        "android:exported=\"false\""
                    ],
                    "validation_steps": [
                        "Check components",
                        "Analyze exports",
                        "Review permissions",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "Component declaration",
                        "Export handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 95,
                    "dynamic_analysis": 85,
                    "manual_review": 90
                }
            },
            "exploit": {
                "difficulty": "Easy",
                "steps": [
                    "Identify component",
                    "Check export",
                    "Access component",
                    "Execute operation",
                    "Extract data"
                ],
                "requirements": [
                    "Component name",
                    "Intent creation",
                    "Access pattern"
                ],
                "verification": {
                    "test_cases": [
                        "Test export",
                        "Check access",
                        "Verify operation"
                    ],
                    "expected_results": [
                        "Component exposed",
                        "Access gained",
                        "Operation executed"
                    ]
                }
            },
            "affected_components": [
                "Activity components",
                "Service components",
                "Broadcast receivers",
                "Content providers"
            ],
            "tags": [
                "manifest",
                "export",
                "component",
                "permission"
            ]
        },
        {
            "id": "MAN-002",
            "name": "Debug Flag Enabled",
            "description": "Application's manifest enables debugging, potentially exposing sensitive information and debugging capabilities.",
            "severity": {
                "level": "High",
                "impact": "Information exposure and debugging access",
                "exploitability": "Medium"
            },
            "affects": {
                "component": "AndroidManifest.xml",
                "attributes": [
                    "android:debuggable",
                    "android:allowBackup",
                    "android:networkSecurityConfig"
                ],
                "elements": [
                    "application"
                ]
            },
            "detection": {
                "pattern": [
                    "android:debuggable=\"true\"",
                    "android:allowBackup=\"true\"",
                    "networkSecurityConfig"
                ],
                "method": "static",
                "indicators": [
                    "Debug flag",
                    "Backup settings",
                    "Security config"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Application element",
                        "Debug handling",
                        "Config validation"
                    ],
                    "exclusion_patterns": [
                        "android:debuggable=\"false\"",
                        "android:allowBackup=\"false\"",
                        "cleartextTrafficPermitted=\"false\""
                    ],
                    "validation_steps": [
                        "Check flags",
                        "Analyze config",
                        "Review settings",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "Application element",
                        "Debug handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 95,
                    "dynamic_analysis": 90,
                    "manual_review": 85
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Check flags",
                    "Attach debugger",
                    "Access data",
                    "Extract information",
                    "Modify runtime"
                ],
                "requirements": [
                    "Debug tools",
                    "Application access",
                    "Runtime knowledge"
                ],
                "verification": {
                    "test_cases": [
                        "Test debugging",
                        "Check access",
                        "Verify extraction"
                    ],
                    "expected_results": [
                        "Debugger attached",
                        "Data accessed",
                        "Information extracted"
                    ]
                }
            },
            "affected_components": [
                "Application runtime",
                "Debug interface",
                "Security settings"
            ],
            "tags": [
                "manifest",
                "debug",
                "backup",
                "security"
            ]
        },
        {
            "id": "MAN-003",
            "name": "Custom Permission Weakness",
            "description": "Application's manifest defines custom permissions with weak protection levels or improper configuration.",
            "severity": {
                "level": "High",
                "impact": "Permission bypass and privilege escalation",
                "exploitability": "Medium"
            },
            "affects": {
                "component": "AndroidManifest.xml",
                "attributes": [
                    "android:protectionLevel",
                    "android:permissionGroup",
                    "android:label"
                ],
                "elements": [
                    "permission",
                    "permission-group",
                    "uses-permission"
                ]
            },
            "detection": {
                "pattern": [
                    "<permission[^>]+android:protectionLevel=\"normal\"",
                    "<permission[^>]+android:protectionLevel=\"dangerous\"",
                    "<uses-permission"
                ],
                "method": "static",
                "indicators": [
                    "Permission definition",
                    "Protection level",
                    "Permission usage"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Permission declaration",
                        "Level handling",
                        "Usage validation"
                    ],
                    "exclusion_patterns": [
                        "android:protectionLevel=\"signature\"",
                        "android:protectionLevel=\"signatureOrSystem\"",
                        "validatePermission"
                    ],
                    "validation_steps": [
                        "Check permissions",
                        "Analyze levels",
                        "Review usage",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "Permission declaration",
                        "Level handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 85,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Identify permission",
                    "Check level",
                    "Request grant",
                    "Bypass protection",
                    "Escalate privileges"
                ],
                "requirements": [
                    "Permission name",
                    "Protection knowledge",
                    "Grant pattern"
                ],
                "verification": {
                    "test_cases": [
                        "Test request",
                        "Check grant",
                        "Verify bypass"
                    ],
                    "expected_results": [
                        "Permission granted",
                        "Protection bypassed",
                        "Privileges escalated"
                    ]
                }
            },
            "affected_components": [
                "Permission system",
                "Protection levels",
                "Permission groups"
            ],
            "tags": [
                "manifest",
                "permission",
                "protection",
                "escalation"
            ]
        },
        {
            "id": "MAN-004",
            "name": "Intent Filter Exposure",
            "description": "Application's manifest defines overly broad intent filters that can be exploited by malicious applications.",
            "severity": {
                "level": "High",
                "impact": "Component hijacking and data interception",
                "exploitability": "Medium"
            },
            "affects": {
                "component": "AndroidManifest.xml",
                "elements": [
                    "intent-filter",
                    "action",
                    "category",
                    "data"
                ],
                "components": [
                    "activity",
                    "service",
                    "receiver"
                ]
            },
            "detection": {
                "pattern": [
                    "<intent-filter>[^<]*<action[^>]+android:name=\"android\\.intent\\.action\\.",
                    "<category[^>]+android:name=\"android\\.intent\\.category\\.DEFAULT\"",
                    "<data[^>]+android:scheme="
                ],
                "method": "static",
                "indicators": [
                    "Intent filter",
                    "Action declaration",
                    "Category usage"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Filter declaration",
                        "Action handling",
                        "Category validation"
                    ],
                    "exclusion_patterns": [
                        "validateIntent",
                        "checkAction",
                        "verifyCategory"
                    ],
                    "validation_steps": [
                        "Check filters",
                        "Analyze actions",
                        "Review categories",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "Filter declaration",
                        "Action handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 85,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Identify filter",
                    "Create intent",
                    "Send broadcast",
                    "Intercept data",
                    "Hijack component"
                ],
                "requirements": [
                    "Filter pattern",
                    "Intent creation",
                    "Broadcast control"
                ],
                "verification": {
                    "test_cases": [
                        "Test filter",
                        "Check interception",
                        "Verify hijacking"
                    ],
                    "expected_results": [
                        "Intent intercepted",
                        "Data captured",
                        "Component hijacked"
                    ]
                }
            },
            "affected_components": [
                "Intent filters",
                "Component declarations",
                "Intent handlers"
            ],
            "tags": [
                "manifest",
                "intent-filter",
                "hijacking",
                "interception"
            ]
        },
        {
            "id": "MAN-005",
            "name": "Backup Flag Misconfiguration",
            "description": "Application's manifest enables data backup without proper protection, potentially exposing sensitive data.",
            "severity": {
                "level": "High",
                "impact": "Data exposure and backup extraction",
                "exploitability": "Medium"
            },
            "affects": {
                "component": "AndroidManifest.xml",
                "attributes": [
                    "android:allowBackup",
                    "android:fullBackupContent",
                    "android:backupAgent"
                ],
                "elements": [
                    "application"
                ]
            },
            "detection": {
                "pattern": [
                    "android:allowBackup=\"true\"",
                    "android:fullBackupContent=\"true\"",
                    "<application[^>]+(?!android:allowBackup)"
                ],
                "method": "static",
                "indicators": [
                    "Backup settings",
                    "Content handling",
                    "Agent declaration"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Backup configuration",
                        "Content handling",
                        "Agent validation"
                    ],
                    "exclusion_patterns": [
                        "android:allowBackup=\"false\"",
                        "android:fullBackupContent=\"false\"",
                        "validateBackup"
                    ],
                    "validation_steps": [
                        "Check settings",
                        "Analyze content",
                        "Review agent",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "Backup configuration",
                        "Content handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 95,
                    "dynamic_analysis": 85,
                    "manual_review": 90
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Check flags",
                    "Create backup",
                    "Extract data",
                    "Analyze content",
                    "Access information"
                ],
                "requirements": [
                    "Backup tools",
                    "ADB access",
                    "Extraction knowledge"
                ],
                "verification": {
                    "test_cases": [
                        "Test backup",
                        "Check extraction",
                        "Verify access"
                    ],
                    "expected_results": [
                        "Backup created",
                        "Data extracted",
                        "Information accessed"
                    ]
                }
            },
            "affected_components": [
                "Backup system",
                "Data storage",
                "Backup agent"
            ],
            "tags": [
                "manifest",
                "backup",
                "data",
                "exposure"
            ]
        }
    ]
}