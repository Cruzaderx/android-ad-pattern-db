{
    "metadata": {
        "category": "NFC Security",
        "version": "1.0.0",
        "last_updated": "2025-02-22T09:04:00Z",
        "description": "Advanced NFC security vulnerabilities in Android applications including tag manipulation, relay attacks, and data interception"
    },
    "vulnerabilities": [
        {
            "id": "NFC-003",
            "name": "NFC NDEF Data Manipulation",
            "description": "Application fails to properly validate NDEF message content, enabling data manipulation and malicious payload injection.",
            "severity": {
                "level": "High",
                "impact": "Data manipulation, payload injection, and malicious code execution",
                "exploitability": "Medium"
            },
            "detection": {
                "pattern": [
                    "createNdefMessage\\([^)]+\\)",
                    "(?<!validate)NdefMessage\\.[^;]+",
                    "writeNdefMessage\\([^)]+\\)",
                    "NdefRecord\\.createUri\\([^)]+\\)"
                ],
                "method": "static",
                "indicators": [
                    "NDEF handling",
                    "Message creation",
                    "Data writing",
                    "Record validation"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "NFC usage",
                        "NDEF handling",
                        "Data validation"
                    ],
                    "exclusion_patterns": [
                        "validateNdef",
                        "checkMessage",
                        "secureRecord"
                    ],
                    "validation_steps": [
                        "Check messages",
                        "Analyze records",
                        "Review content",
                        "Verify validation"
                    ],
                    "context_requirements": [
                        "NFC implementation",
                        "NDEF handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 85,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Create payload",
                    "Craft message",
                    "Write data",
                    "Trigger read",
                    "Execute payload"
                ],
                "requirements": [
                    "NFC knowledge",
                    "NDEF crafting",
                    "Data manipulation"
                ],
                "verification": {
                    "test_cases": [
                        "Write message",
                        "Read data",
                        "Check execution"
                    ],
                    "expected_results": [
                        "Message written",
                        "Data manipulated",
                        "Payload executed"
                    ]
                }
            },
            "affected_components": [
                "NFC system",
                "NDEF handler",
                "Data processor"
            ],
            "tags": [
                "nfc",
                "ndef",
                "manipulation",
                "injection"
            ]
        },
        {
            "id": "NFC-004",
            "name": "NFC Card Emulation Bypass",
            "description": "Application implements weak Host Card Emulation (HCE) security controls, enabling unauthorized card emulation and transaction manipulation.",
            "severity": {
                "level": "Critical",
                "impact": "Transaction manipulation, unauthorized access, and financial fraud",
                "exploitability": "Hard"
            },
            "detection": {
                "pattern": [
                    "HostApduService",
                    "processCommandApdu\\([^)]+\\)",
                    "(?<!secure)CardEmulation[A-Z][a-zA-Z]*\\.[^;]+",
                    "AID_GROUP_[^\\s]+"
                ],
                "method": "static",
                "indicators": [
                    "HCE usage",
                    "APDU handling",
                    "Card emulation",
                    "Transaction processing"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "HCE implementation",
                        "APDU handling",
                        "Security controls"
                    ],
                    "exclusion_patterns": [
                        "validateApdu",
                        "secureEmulation",
                        "checkTransaction"
                    ],
                    "validation_steps": [
                        "Check emulation",
                        "Analyze APDUs",
                        "Review security",
                        "Verify controls"
                    ],
                    "context_requirements": [
                        "HCE implementation",
                        "Transaction handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 85,
                    "dynamic_analysis": 90,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Hard",
                "steps": [
                    "Analyze HCE",
                    "Create emulator",
                    "Craft APDUs",
                    "Bypass controls",
                    "Execute transaction"
                ],
                "requirements": [
                    "HCE knowledge",
                    "APDU crafting",
                    "Transaction handling"
                ],
                "verification": {
                    "test_cases": [
                        "Emulate card",
                        "Send APDUs",
                        "Check transaction"
                    ],
                    "expected_results": [
                        "Card emulated",
                        "Controls bypassed",
                        "Transaction processed"
                    ]
                }
            },
            "affected_components": [
                "HCE system",
                "APDU handler",
                "Transaction processor"
            ],
            "tags": [
                "nfc",
                "hce",
                "emulation",
                "transaction"
            ]
        },
        {
            "id": "NFC-005",
            "name": "NFC Reader Mode Exploitation",
            "description": "Application fails to properly secure NFC reader mode, enabling unauthorized tag reading and data interception.",
            "severity": {
                "level": "High",
                "impact": "Data theft, privacy violation, and unauthorized access",
                "exploitability": "Medium"
            },
            "detection": {
                "pattern": [
                    "enableReaderMode\\([^)]+\\)",
                    "(?<!secure)ReaderCallback\\.[^;]+",
                    "onTagDiscovered\\([^)]+\\)",
                    "NfcAdapter\\.FLAG_READER_[^\\s]+"
                ],
                "method": "static",
                "indicators": [
                    "Reader mode",
                    "Tag discovery",
                    "Callback handling",
                    "Data reading"
                ],
                "accuracy_improvements": {
                    "required_conditions": [
                        "Reader usage",
                        "Tag handling",
                        "Data processing"
                    ],
                    "exclusion_patterns": [
                        "validateReader",
                        "secureCallback",
                        "checkTag"
                    ],
                    "validation_steps": [
                        "Check reader",
                        "Analyze callbacks",
                        "Review handling",
                        "Verify security"
                    ],
                    "context_requirements": [
                        "Reader implementation",
                        "Tag handling"
                    ]
                },
                "confidence_score": {
                    "static_analysis": 90,
                    "dynamic_analysis": 85,
                    "manual_review": 95
                }
            },
            "exploit": {
                "difficulty": "Medium",
                "steps": [
                    "Enable reader",
                    "Intercept data",
                    "Read tags",
                    "Extract information",
                    "Bypass controls"
                ],
                "requirements": [
                    "NFC knowledge",
                    "Reader control",
                    "Data extraction"
                ],
                "verification": {
                    "test_cases": [
                        "Read tag",
                        "Extract data",
                        "Check controls"
                    ],
                    "expected_results": [
                        "Tag read",
                        "Data extracted",
                        "Controls bypassed"
                    ]
                }
            },
            "affected_components": [
                "NFC reader",
                "Tag handler",
                "Data processor"
            ],
            "tags": [
                "nfc",
                "reader",
                "interception",
                "data-theft"
            ]
        }
    ]
}